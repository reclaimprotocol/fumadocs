<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1242" height="954"><desc>title%20Executing%20the%20TLS%20Proof%20of%20Provenance%20Protocol%0AUser-%3EAttestor%3A%20Sending%20all%20necessary%20info%20to%20connect%20to%20a%20target%20website%20(TLS%20client%20handshake%20message)%0AAttestor-%3EWebsite%3A%20Transfers%20these%20data%20(using%20provided%20host%20and%20port)%0AWebsite-%3EAttestor%3A%20TLS%20server%20handshake%20message%0AAttestor-%3EUser%3A%20Transferring%20TLS%20server%20handshake%20message%0AUser-%3EAttestor%3A%20Encrypted%20request%20message%3A%20%7Bprivate%20part%2C%20key%20update%20message%2C%20public%20part%2C%20key%20update%20message%2C%20private%20part%7D%0AAttestor-%3EWebsite%3A%20Transferring%20encrypted%20request%20message%0AWebsite-%3EAttestor%3A%20Encrypted%20response%20message%0AAttestor-%3EUser%3A%20Transferring%20encrypted%20response%20message%0AUser-%3EUser%3A%20Detects%20the%20part%20of%20response%20that%20needs%20to%20be%20revealed%0AUser-%3EUser%3A%20Creates%20ZK%20Proof%20that%20the%20revealed%20response%20part%20corresponds%20to%20the%20part%20of%20encrypted%20response%0AUser-%3EAttestor%3A%20Sends%3A%20%7Brequest%20public%20part%20sending%20key%2C%20redacted%20ciphertext%2C%20redacted%20plaintext%2C%20ZK%20Proof%7D%0AAttestor-%3EAttestor%3A%20Verifies%20correct%20request%20was%20sent%0AAttestor-%3EAttestor%20%3A%20Verifies%20correctness%20of%20inputs%20to%20ZK%20Proof%0AAttestor-%3EUser%20%3A%20Signature%20on%20the%20encrypted%20response%0A%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1242" height="954"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="384.4159659443484" y="26.3876361" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Executing the TLS Proof of Provenance Protocol</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 103.26361593799999 L 43.35894866259375 954.7046740979998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 103.26361593799999 L 808.2012099323855 954.7046740979998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1187.8682392685835 103.26361593799999 L 1187.8682392685835 954.7046740979998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.765870957999994 L 77.92201862518749 55.765870957999994 L 77.92201862518749 103.26361593799999 L 8.795878699999996 103.26361593799999 L 8.795878699999996 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 763.8564703530925 55.765870957999994 L 852.5459495116785 55.765870957999994 L 852.5459495116785 103.26361593799999 L 763.8564703530925 103.26361593799999 L 763.8564703530925 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="782.9435271320925" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestor</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1142.4318706609702 55.765870957999994 L 1233.3046078761968 55.765870957999994 L 1233.3046078761968 103.26361593799999 L 1142.4318706609702 103.26361593799999 L 1142.4318706609702 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1161.5189274399702" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Website</text></g></g><g><g><g><rect fill="white" stroke="none" x="130.5895883925677" y="138.44713073799997" width="590.3809818098438" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="133.2283520025677" y="154.279712398" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sending all necessary info to connect to a target website (TLS client handshake message)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 161.31641535799997 L 793.7173296730522 161.31641535799997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,161.31641535799997) translate(-808.2012099323855,-161.31641535799997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 793.5414120990522 153.9865164413333 L 808.2012099323855 161.31641535799997 L 793.5414120990522 168.64631427466665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="829.0181228557188" y="187.70405145799995" width="338.0332034895313" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.6568864657188" y="203.53663311799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transfers these data (using provided host and port)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 210.57333607799995 L 1173.3843590092501 210.57333607799995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1187.8682392685835,210.57333607799995) translate(-1187.8682392685835,-210.57333607799995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1173.20844143525 203.24343716133328 L 1187.8682392685835 210.57333607799995 L 1173.20844143525 217.90323499466663 Z"/></g></g><g><g><rect fill="white" stroke="none" x="889.8698760905821" y="236.96097217799993" width="216.32969701980468" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="892.5086397005821" y="252.79355383799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TLS server handshake message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1187.8682392685835 259.83025679799994 L 822.6850901917188 259.83025679799994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,259.83025679799994) translate(-808.2012099323855,-259.83025679799994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 822.8610077657188 252.50035788133326 L 808.2012099323855 259.83025679799994 L 822.8610077657188 267.1601557146666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="276.33394264061457" y="286.21789289799995" width="298.89227331375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="278.9727062506146" y="302.05047455799996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transferring TLS server handshake message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 309.0871775179999 L 57.84282892192708 309.0871775179999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,309.0871775179999) translate(-43.35894866259375,-309.0871775179999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 301.75727860133327 L 43.35894866259375 309.0871775179999 L 58.018746495927076 316.41707643466657 Z"/></g></g><g><g><rect fill="white" stroke="none" x="64.17586158592708" y="335.4748136179999" width="723.208435423125" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.81462519592708" y="351.30739527799994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypted request message: {private part, key update message, public part, key update message, private part}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 358.3440982379999 L 793.7173296730522 358.3440982379999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,358.3440982379999) translate(-808.2012099323855,-358.3440982379999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 793.5414120990522 351.01419932133325 L 808.2012099323855 358.3440982379999 L 793.5414120990522 365.67399715466655 Z"/></g></g><g><g><rect fill="white" stroke="none" x="863.6601516643126" y="384.7317343379999" width="268.7491458723438" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="866.2989152743125" y="400.5643159979999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transferring encrypted request message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 407.6010189579999 L 1173.3843590092501 407.6010189579999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1187.8682392685835,407.6010189579999) translate(-1187.8682392685835,-407.6010189579999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1173.20844143525 400.27112004133323 L 1187.8682392685835 407.6010189579999 L 1173.20844143525 414.93091787466653 Z"/></g></g><g><g><rect fill="white" stroke="none" x="898.4239227214415" y="433.9886550579999" width="199.22160375808593" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="901.0626863314415" y="449.8212367179999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypted response message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1187.8682392685835 456.85793967799987 L 822.6850901917188 456.85793967799987" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,456.85793967799987) translate(-808.2012099323855,-456.85793967799987)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 822.8610077657188 449.5280407613332 L 808.2012099323855 456.85793967799987 L 822.8610077657188 464.1878385946665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="285.7004282363177" y="483.2455757779999" width="280.1593021223438" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="288.3391918463177" y="499.0781574379999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Transferring encrypted response message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 506.11486039799985 L 57.84282892192708 506.11486039799985" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,506.11486039799985) translate(-43.35894866259375,-506.11486039799985)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 498.7849614813332 L 43.35894866259375 506.11486039799985 L 58.018746495927076 513.4447593146665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="64.17586158592708" y="532.5024964979999" width="358.9710086653125" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.81462519592708" y="548.3350781579999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Detects the part of response that needs to be revealed</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 555.3717811179998 L 113.72597826259374 555.3717811179998 L 113.72597826259374 578.2410657379999 L 57.84282892192708 578.2410657379999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,578.2410657379999) translate(-43.35894866259375,-578.2410657379999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 570.9111668213332 L 43.35894866259375 578.2410657379999 L 58.018746495927076 585.5709646546666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="64.17586158592708" y="604.6287018379999" width="629.4934696028125" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.81462519592708" y="620.4612834979998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Creates ZK Proof that the revealed response part corresponds to the part of encrypted response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 627.4979864579998 L 113.72597826259374 627.4979864579998 L 113.72597826259374 650.3672710779998 L 57.84282892192708 650.3672710779998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,650.3672710779998) translate(-43.35894866259375,-650.3672710779998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 643.0373721613331 L 43.35894866259375 650.3672710779998 L 58.018746495927076 657.6971699946665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="131.12288307030207" y="676.7549071779998" width="589.314392454375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="133.76164668030208" y="692.5874888379998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sends: {request public part sending key, redacted ciphertext, redacted plaintext, ZK Proof}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 43.35894866259375 699.6241917979999 L 793.7173296730522 699.6241917979999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,699.6241917979999) translate(-808.2012099323855,-699.6241917979999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 793.5414120990522 692.2942928813331 L 808.2012099323855 699.6241917979999 L 793.5414120990522 706.9540907146666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="829.0181228557188" y="726.0118278979999" width="217.13139379714843" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.6568864657188" y="741.8444095579998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verifies correct request was sent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 748.8811125179998 L 878.5682395323855 748.8811125179998 L 878.5682395323855 771.7503971379998 L 822.6850901917188 771.7503971379998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,771.7503971379998) translate(-808.2012099323855,-771.7503971379998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 822.8610077657188 764.4204982213331 L 808.2012099323855 771.7503971379998 L 822.8610077657188 779.0802960546665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="829.0181228557188" y="798.1380332379998" width="270.9108890364063" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.6568864657188" y="813.9706148979998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verifies correctness of inputs to ZK Proof</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 821.0073178579997 L 878.5682395323855 821.0073178579997 L 878.5682395323855 843.8766024779998 L 822.6850901917188 843.8766024779998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(808.2012099323855,843.8766024779998) translate(-808.2012099323855,-843.8766024779998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 822.8610077657188 836.5467035613331 L 808.2012099323855 843.8766024779998 L 822.8610077657188 851.2065013946665 Z"/></g></g><g><g><rect fill="white" stroke="none" x="302.93020271141535" y="870.2642385779998" width="245.69975317214843" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="305.56896632141536" y="886.0968202379997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Signature on the encrypted response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 808.2012099323855 893.1335231979998 L 57.84282892192708 893.1335231979998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(43.35894866259375,893.1335231979998) translate(-43.35894866259375,-893.1335231979998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.018746495927076 885.8036242813331 L 43.35894866259375 893.1335231979998 L 58.018746495927076 900.4634221146665 Z"/></g></g></g><g/><g/><g/></g></svg>